<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>three.js记录 | heyLiup blog</title>
    <meta name="description" content="个人收藏夹">
    <link rel="icon" href="/favicon.ico">
    
    <link rel="preload" href="/assets/css/0.styles.427ef87a.css" as="style"><link rel="preload" href="/assets/js/app.dece0b7a.js" as="script"><link rel="preload" href="/assets/js/22.033fe2e4.js" as="script"><link rel="prefetch" href="/assets/js/10.40583a6a.js"><link rel="prefetch" href="/assets/js/11.4d760abf.js"><link rel="prefetch" href="/assets/js/12.a8ce03e3.js"><link rel="prefetch" href="/assets/js/13.19574711.js"><link rel="prefetch" href="/assets/js/14.178490b3.js"><link rel="prefetch" href="/assets/js/15.72d206d3.js"><link rel="prefetch" href="/assets/js/16.4d4e2323.js"><link rel="prefetch" href="/assets/js/17.7e4bd451.js"><link rel="prefetch" href="/assets/js/18.003df505.js"><link rel="prefetch" href="/assets/js/19.379e1a95.js"><link rel="prefetch" href="/assets/js/2.e3c16dc1.js"><link rel="prefetch" href="/assets/js/20.c0868506.js"><link rel="prefetch" href="/assets/js/21.dac1de0b.js"><link rel="prefetch" href="/assets/js/23.f02097a1.js"><link rel="prefetch" href="/assets/js/24.a693fe9f.js"><link rel="prefetch" href="/assets/js/25.31d87481.js"><link rel="prefetch" href="/assets/js/26.c68eb7de.js"><link rel="prefetch" href="/assets/js/27.5d0b212c.js"><link rel="prefetch" href="/assets/js/28.e59773ad.js"><link rel="prefetch" href="/assets/js/29.ff2c20c8.js"><link rel="prefetch" href="/assets/js/3.8b2a45ed.js"><link rel="prefetch" href="/assets/js/30.0dfe8dbc.js"><link rel="prefetch" href="/assets/js/31.df7344c8.js"><link rel="prefetch" href="/assets/js/32.263ae62c.js"><link rel="prefetch" href="/assets/js/33.0882d5b6.js"><link rel="prefetch" href="/assets/js/34.e35cfe90.js"><link rel="prefetch" href="/assets/js/4.ef86a311.js"><link rel="prefetch" href="/assets/js/5.722e2ee1.js"><link rel="prefetch" href="/assets/js/6.40a01e07.js"><link rel="prefetch" href="/assets/js/7.57166950.js"><link rel="prefetch" href="/assets/js/8.91b9b970.js"><link rel="prefetch" href="/assets/js/9.cba8bff0.js">
    <link rel="stylesheet" href="/assets/css/0.styles.427ef87a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">heyLiup blog</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link router-link-active">Blog</a></div> <a href="https://github.com/heyLiup" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link router-link-active">Blog</a></div> <a href="https://github.com/heyLiup" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>Blog</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog/" aria-current="page" class="sidebar-link">记录点滴</a></li><li><a href="/blog/dom.html" class="sidebar-link">dom相关</a></li><li><a href="/blog/js.html" class="sidebar-link">js记录</a></li><li><a href="/blog/leetcode.html" class="sidebar-link">leetcodes 记录</a></li><li><a href="/blog/sort-algorithm.html" class="sidebar-link">常用排序算法</a></li><li><a href="/blog/three.html" aria-current="page" class="active sidebar-link">three.js记录</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/three.html#入门" class="sidebar-link">入门</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/three.html#经验" class="sidebar-link">经验</a></li><li class="sidebar-sub-header"><a href="/blog/three.html#问题" class="sidebar-link">问题</a></li><li class="sidebar-sub-header"><a href="/blog/three.html#插件" class="sidebar-link">插件</a></li></ul></li></ul></li><li><a href="/blog/tools.html" class="sidebar-link">工具</a></li><li><a href="/blog/webpack.html" class="sidebar-link">webpack</a></li><li><a href="/blog/采坑记.html" class="sidebar-link">采坑记</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="three-js记录"><a href="#three-js记录" class="header-anchor">#</a> three.js记录</h1> <h2 id="入门"><a href="#入门" class="header-anchor">#</a> 入门</h2> <ol><li>three.js中完成3D绘图的三大要素</li></ol> <blockquote><p>有一个场景(scene)，通过相机(carmer)各种拍摄，最后通过渲染器(render)转化为用户所见的图像</p></blockquote> <ol start="2"><li>场景</li></ol> <blockquote><p>场景是所有物体的容器，场景只有一种</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> scene <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Scene</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><ol start="3"><li>相机</li></ol> <blockquote><p>透视相机(perspectiveCamera)</p></blockquote> <table><thead><tr><th style="text-align:left">透视相机参数</th> <th style="text-align:left">介绍</th></tr></thead> <tbody><tr><td style="text-align:left">fov</td> <td style="text-align:left">表示视场，即摄像机能看到的视野。推荐默认值50</td></tr> <tr><td style="text-align:left">aspect</td> <td style="text-align:left">指定渲染结果横向尺寸和纵向尺寸的比值，推荐默认值为窗口的长宽比，即window.innerWidth/window.innerHeight</td></tr> <tr><td style="text-align:left">near</td> <td style="text-align:left">指定从距离摄像机多近的位置开始渲染，推荐默认值0.1</td></tr> <tr><td style="text-align:left">far</td> <td style="text-align:left">指定摄像机从它所在的位置最远能看到多远，太小场景中的远处不会被渲染，太大会浪费资源影响性能，推荐默认值1000</td></tr></tbody></table> <blockquote><p>正交投影相机(OrthographicCamera) : 在这种投影模式下，无论物体距离相机距离远或者近，在最终渲染的图片中物体的大小都保持不变</p></blockquote> <ol start="4"><li>坐标轴</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token keyword">var</span> axisHelper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>AxisHelper</span><span class="token punctuation">(</span><span class="token number">250</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>axisHelper<span class="token punctuation">)</span>

<span class="token comment">//坐标轴的颜色 rgb 分别代表 xyz轴</span>
</code></pre></div><ol start="5"><li>时间THREE.Clock</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>requestAnimationFrame 执行的时间间隔不一致，可使用 Clock来准确计算时间

</code></pre></div><h3 id="经验"><a href="#经验" class="header-anchor">#</a> 经验</h3> <ol><li><p>sence坐标中心点(0, 0, 0)为容器中心，所以创建的物体默认居中</p></li> <li><p>向量的<code>.copy</code>(复制)与<code>.clone</code>(克隆)</p></li></ol> <p>对象执行<code>.clone()</code>方法，返回一个新的对象，与原对象一致</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> copyA <span class="token operator">=</span> a<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//源码</span>

<span class="token keyword">function</span> <span class="token function-variable function">clone</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>constructor</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>y<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>z<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>执行<code>b.copy(a)</code>方法，向量a三个分量的xyz将覆盖b三个分量</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
a<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// a = b = THREE.Vector3 {x: 0, y: 0, z: 0}</span>
</code></pre></div><ol start="3"><li>向量加减</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//计算b点到坐标原点的距离</span>
b<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//5.196152422706632</span>

<span class="token comment">//向量相减 (a的值会改变，如果不期望改变a值，计算前先clone一份)</span>
a<span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">//THREE.Vector3 {x: -2, y: -2, z: -2}</span>

<span class="token comment">//计算a和b之间的距离  (结果为绝对值)</span>
a<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment">//3.4641016151377544</span>

</code></pre></div><p>3.点积(点乘) .dot()</p> <img src="./three/images/dot.png" alt="dock"> <div class="language-js extra-class"><pre class="language-js"><code>已知三角形的三个顶点，求其中一个顶点对应角度的余弦值。


<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//求a点对应角度的余弦值</span>

<span class="token comment">// a, b两点确定向量x</span>
<span class="token keyword">var</span> x <span class="token operator">=</span> a<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//THREE.Vector3 {x: -20, y: 0, z: 0}</span>
<span class="token keyword">var</span> y <span class="token operator">=</span> a<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//THREE.Vector3 {x: 0, y: -40, z: 0}</span>

<span class="token comment">// dot = function (v) {</span>
<span class="token comment">//     return this.x * v.x + this.y + v.y + this.z + v.z;</span>
<span class="token comment">// }</span>

<span class="token keyword">var</span> cosValue <span class="token operator">=</span> x<span class="token punctuation">.</span><span class="token function">dot</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> y<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'三角形余弦值'</span> <span class="token operator">+</span> cosValue<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 三角形余弦值0</span>

<span class="token comment">//Math.acos(cosValue)*180 为弧度</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'a顶点两边夹角为'</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">acos</span><span class="token punctuation">(</span>cosValue<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">180</span> <span class="token operator">/</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//a顶点两边夹角为90</span>

</code></pre></div><ol start="4"><li>叉乘</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//1.计算两个向量的叉乘</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

c<span class="token punctuation">.</span><span class="token function">crossVectors</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>  <span class="token comment">//c: THREE.Vector3 {x: 0, y: 0, z: 0}</span>

<span class="token comment">//2.根据三个点求出三角形的面积</span>
<span class="token keyword">function</span> <span class="token function">AreaOfrange</span> <span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token comment">//声明两个空的向量</span>
    <span class="token keyword">var</span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//根据两个顶点坐标坐标算出两个向量</span>
    <span class="token keyword">var</span> v1 <span class="token operator">=</span> x<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> v2 <span class="token operator">=</span> x<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span>z<span class="token punctuation">)</span><span class="token punctuation">;</span>

    p1<span class="token punctuation">.</span><span class="token function">crossVectors</span><span class="token punctuation">(</span>v1<span class="token punctuation">,</span> v2<span class="token punctuation">)</span>
    <span class="token keyword">return</span> p1<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> d <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">AreaOfrange</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> d<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">//3.多面体都是由三角形构成，可通过三角形的数量乘以三角形的表面积，得出不规则物体的表面积</span>

<span class="token comment">//长宽高为10 的立方体</span>
<span class="token comment">// var box = new THREE.BoxGeometry(10, 10, 10);</span>

<span class="token comment">//球体 </span>
<span class="token comment">//radius(半径), widthSegments(水平分段数（沿着经线分段），最小值为3，默认值为8</span>
<span class="token keyword">var</span> box <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>SphereGeometry</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token number">8</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> area <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> len <span class="token operator">=</span> box<span class="token punctuation">.</span>faces<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//三角形对应顶点索引</span>
    <span class="token keyword">var</span> pointA <span class="token operator">=</span> box<span class="token punctuation">.</span>faces<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>a<span class="token punctuation">;</span>
    <span class="token keyword">var</span> pointB <span class="token operator">=</span> box<span class="token punctuation">.</span>faces<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>b<span class="token punctuation">;</span>
    <span class="token keyword">var</span> pointC <span class="token operator">=</span> box<span class="token punctuation">.</span>faces<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>c<span class="token punctuation">;</span>

    <span class="token comment">//获得三角形三个顶点的坐标</span>
    <span class="token keyword">var</span> p1 <span class="token operator">=</span> box<span class="token punctuation">.</span>vertices<span class="token punctuation">[</span>pointA<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> p2 <span class="token operator">=</span> box<span class="token punctuation">.</span>vertices<span class="token punctuation">[</span>pointB<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> p3 <span class="token operator">=</span> box<span class="token punctuation">.</span>vertices<span class="token punctuation">[</span>pointC<span class="token punctuation">]</span><span class="token punctuation">;</span>

    area <span class="token operator">+=</span> <span class="token function">AreaOfrange</span><span class="token punctuation">(</span>p1<span class="token punctuation">,</span> p2<span class="token punctuation">,</span> p3<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>area<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><ol start="5"><li>获得顶点坐标几种方式</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token number">1.</span>获得曲线的顶点坐标

<span class="token comment">//创建椭圆曲线</span>
<span class="token keyword">var</span> curve <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>EllipseCurve</span><span class="token punctuation">(</span>
    <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token comment">// ax, aY</span>
    <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>           <span class="token comment">// xRadius, yRadius</span>
    <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">2</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">,</span>  <span class="token comment">// aStartAngle, aEndAngle</span>
    <span class="token boolean">false</span><span class="token punctuation">,</span>            <span class="token comment">// aClockwise</span>
    <span class="token number">0</span>                 <span class="token comment">// aRotation</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//划分成100份，得到101个坐标</span>
curve<span class="token punctuation">.</span><span class="token function">getPoints</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>  

<span class="token comment">//创建三维样条曲线</span>
<span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>CatmullRomCurve3</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

</code></pre></div><ol start="6"><li>修复出现锯齿的情况</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token keyword">let</span> renderer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>WebGLRenderer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    antialias<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token comment">//precision:&quot;lowp&quot;  //着色器的精度。可以是&quot;highp&quot;, &quot;mediump&quot; 或 &quot;lowp&quot;. 默认为&quot;highp&quot;，如果设备支持的话。</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


</code></pre></div><ol start="7"><li>查看THREE.js版本</li></ol> <div class="language- extra-class"><pre class="language-text"><code>THREE.REVISION // '113'
</code></pre></div><ol start="8"><li>给缓冲类型集合体设置属性</li></ol> <div class="language- extra-class"><pre class="language-text"><code>var positions = new Float32Array( length * 3 );
geometry.setAttribute( 'position', new THREE.BufferAttribute( positions, 3 ) );
</code></pre></div><ol start="9"><li>渲染点 片元坐标gl_PointCoord</li></ol> <div class="language- extra-class"><pre class="language-text"><code>//在片元着色器总将小方块变成小圆球
//比如方形区域的左上角坐标是(0.0,0.0),每个方形区域几何中心坐标是(0.5,0.5)，右下角坐标是(1.0,1.0)
if ( length( gl_PointCoord - vec2( 0.5, 0.5 ) ) &gt; 0.5 ) discard;

</code></pre></div><ol start="10"><li>片元坐标gl_FragCoord</li></ol> <div class="language- extra-class"><pre class="language-text"><code>内置变量gl_FragCoord表示WebGL在canvas画布上渲染的所有片元或者说像素的坐标，坐标原点是canvas画布的左上角，x轴水平向右，y竖直向下，
gl_FragCoord坐标的单位是像素，gl_FragCoord的值是vec2(x,y),通过gl_FragCoord.x、gl_FragCoord.y方式可以分别访问片元坐标的纵横坐标

</code></pre></div><h3 id="问题"><a href="#问题" class="header-anchor">#</a> 问题</h3> <ol><li>创建点、线条、面</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token comment">//声明顶点坐标</span>
<span class="token keyword">var</span> vertices <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Float32Array</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>    <span class="token comment">//顶点1坐标</span>
    <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>



<span class="token comment">//创建空的缓存立方体</span>
<span class="token keyword">var</span> geometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>BufferGeometry</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">//3个数字为一组</span>
<span class="token keyword">var</span> attribute <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>BufferAttribute</span><span class="token punctuation">(</span>vertices<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//添加顶点数据</span>
geometry<span class="token punctuation">.</span>attributes<span class="token punctuation">.</span>position <span class="token operator">=</span> attribute<span class="token punctuation">;</span>


<span class="token comment">//创建面</span>
<span class="token keyword">var</span> material <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshBasicMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    color<span class="token operator">:</span> <span class="token number">0xfffff</span><span class="token punctuation">,</span>
    side<span class="token operator">:</span> <span class="token constant">THREE</span><span class="token punctuation">.</span>DoubleSide   <span class="token comment">//两面可见</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> mesh <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>geometry<span class="token punctuation">,</span> material<span class="token punctuation">)</span>
scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>mesh<span class="token punctuation">)</span>


<span class="token comment">//创建线</span>
<span class="token keyword">var</span> material <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>LineBasicMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    color<span class="token operator">:</span> <span class="token number">0x0000ff</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> Line <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Line</span><span class="token punctuation">(</span>geometry<span class="token punctuation">,</span> material<span class="token punctuation">)</span>
scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>Line<span class="token punctuation">)</span>

<span class="token comment">//创建点</span>
<span class="token keyword">var</span> material <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>PointsMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    color<span class="token operator">:</span> <span class="token number">0x0000ff</span><span class="token punctuation">,</span>
    size<span class="token operator">:</span> <span class="token number">50</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> points <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Points</span><span class="token punctuation">(</span>geometry<span class="token punctuation">,</span> material<span class="token punctuation">)</span>
scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>points<span class="token punctuation">)</span>
</code></pre></div><ol start="2"><li>材质颜色</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token comment">//声明各顶点颜色</span>
<span class="token keyword">var</span> colors <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Float32Array</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>    <span class="token comment">//顶点1颜色</span>
    <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>

    <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>


<span class="token comment">// THREE.NoColors</span>
<span class="token comment">// THREE.FaceColors</span>
<span class="token comment">// THREE.VertexColors</span>

geometry<span class="token punctuation">.</span>attributes<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>BufferAttribute</span><span class="token punctuation">(</span>colors<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//线</span>
<span class="token keyword">var</span> material <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>LineBasicMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    vertexColors<span class="token operator">:</span> <span class="token constant">THREE</span><span class="token punctuation">.</span>VertexColors    <span class="token comment">//选择VertexColors进行颜色的插值计算，可画出有颜色渐变的线条</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> Line <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Line</span><span class="token punctuation">(</span>geometry<span class="token punctuation">,</span> material<span class="token punctuation">)</span>
scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>Line<span class="token punctuation">)</span>

</code></pre></div><ol start="3"><li>投影</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token comment">//渲染器，允许使用阴影贴图</span>
renderer<span class="token punctuation">.</span>shadowMap<span class="token punctuation">.</span>enabled <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

<span class="token comment">//开启光源产生投影</span>
light<span class="token punctuation">.</span>castShadow <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> 

<span class="token comment">//产生投影</span>
mesh<span class="token punctuation">.</span>castShadow <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">//default is false</span>

<span class="token comment">//底座接受投影</span>
planeMesh<span class="token punctuation">.</span>receiveShadow <span class="token operator">=</span> <span class="token boolean">true</span> 

<span class="token comment">//开启投影辅助线</span>
<span class="token keyword">var</span> helper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>CameraHelper</span><span class="token punctuation">(</span> light<span class="token punctuation">.</span>shadow<span class="token punctuation">.</span>camera <span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><ol start="4"><li>ExtrudeGeometry 拉伸</li></ol> <h3 id="插件"><a href="#插件" class="header-anchor">#</a> 插件</h3> <ol><li>OrbitControls
实现鼠标拖拽，放大，平移等交互。<a href="http://www.yanhuangxueyuan.com/threejs/examples/js/controls/OrbitControls.js" target="_blank" rel="noopener noreferrer">下载地址<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ol> <p>用法</p> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token comment">//创建控制器</span>
<span class="token keyword">var</span> controls <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>OrbitControls</span><span class="token punctuation">(</span>camera<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 如果使用animate方法时，将此函数删除 </span>
<span class="token comment">//controls.addEventListener( 'change', render ); </span>

<span class="token comment">// 使动画循环使用时阻尼或自转 意思是否有惯性 </span>
controls<span class="token punctuation">.</span>enableDamping <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> 

<span class="token comment">//动态阻尼系数 就是鼠标拖拽旋转灵敏度 </span>
<span class="token comment">//controls.dampingFactor = 0.25; </span>

<span class="token comment">//是否可以缩放 </span>
controls<span class="token punctuation">.</span>enableZoom <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> 

<span class="token comment">//是否自动旋转 </span>
controls<span class="token punctuation">.</span>autoRotate <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> 

<span class="token comment">//设置相机距离原点的最远距离 </span>
<span class="token comment">// controls.minDistance = 10; </span>

<span class="token comment">//设置相机距离原点的最远距离 </span>
<span class="token comment">// controls.maxDistance = 600; </span>

<span class="token comment">//是否开启右键拖拽 </span>
controls<span class="token punctuation">.</span>enablePan <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> 


</code></pre></div><p>2.stats.js
JavaScript性能监控器，同样也可以测试webgl的渲染性能。<a href="https://github.com/mrdoob/stats.js" target="_blank" rel="noopener noreferrer">下载地址<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>用法</p> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token comment">//创建dom，用于挂载监控器</span>
<span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">&quot;Stats-output&quot;</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>

 <span class="token keyword">var</span> stats <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Stats</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

 <span class="token comment">//设置统计模式</span>
 stats<span class="token punctuation">.</span><span class="token function">setMode</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 0: fps, 1: ms</span>

 <span class="token comment">//统计信息显示在左上角</span>
 stats<span class="token punctuation">.</span>domElement<span class="token punctuation">.</span>style<span class="token punctuation">.</span>position <span class="token operator">=</span> <span class="token string">'absolute'</span><span class="token punctuation">;</span>
 stats<span class="token punctuation">.</span>domElement<span class="token punctuation">.</span>style<span class="token punctuation">.</span>left <span class="token operator">=</span> <span class="token string">'0px'</span><span class="token punctuation">;</span>
 stats<span class="token punctuation">.</span>domElement<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> <span class="token string">'0px'</span><span class="token punctuation">;</span>

 <span class="token comment">//将统计对象添加到对应的&lt;div&gt;元素中</span>
 document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;Stats-output&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>stats<span class="token punctuation">.</span>domElement<span class="token punctuation">)</span><span class="token punctuation">;</span>

 <span class="token comment">//最后在requestAnimationFrame里调用 </span>
 stats<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

</code></pre></div></div> <div class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">8/15/2020, 11:54:44 AM</span></div></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/blog/sort-algorithm.html" class="prev">
          常用排序算法
        </a></span> <span class="next"><a href="/blog/tools.html">
          工具
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/app.dece0b7a.js" defer></script><script src="/assets/js/22.033fe2e4.js" defer></script>
  </body>
</html>
